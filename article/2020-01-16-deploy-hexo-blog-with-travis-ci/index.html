<!DOCTYPE html><html lang="zh-cn" data-color-mode="light"><head><meta charSet="utf-8"/><link rel="shortcut icon" href="/medias/favicon.png"/><meta content="width=device-width, initial-scale=1, viewport-fit=cover" name="viewport"/><meta content="on" http-equiv="x-dns-prefetch-control"/><meta content="telephone=no" name="format-detection"/><title>ä½¿ç”¨Travis-CIéƒ¨ç½²hexoåšå®¢åˆ°è…¾è®¯cos&amp;github-pages | liyang&#x27;s  blog</title><meta name="keywords" content="hexo æ•™ç¨‹ Travis-CI"/><meta name="description" content="å‰è¨€ä»¥å‰æˆ‘çš„åšå®¢é™æ€æ–‡ä»¶æ˜¯æ”¾åœ¨ä¸€ä¸ªå¸¦å®½1Mbpsçš„è…¾è®¯äº‘ä¸»æœºä¸Šï¼Œæ–‡ç« é‡Œçš„å›¾ç‰‡ä¹Ÿæ˜¯æ”¾åœ¨äº‘ä¸»æœºä¸Šçš„ï¼Œå½“æœ‰äº›æ–‡ç« å›¾ç‰‡è¾ƒå¤šçš„æ—¶å€™ï¼ŒåŠ è½½å°±ä¼šå˜å¾—å¾ˆæ…¢ã€‚åæ¥æˆ‘å°†é™æ€æ–‡ä»¶å’Œå›¾ç‰‡å…¨éƒ¨è¿ç§»åˆ°è…¾è®¯å¯¹è±¡å­˜å‚¨(cos)é‡Œï¼Œå¹¶é…ç½®äº†CDNåŠ é€Ÿï¼Œä»æ­¤åŠ è½½é€Ÿåº¦ä¸å†æ˜¯ç“¶é¢ˆï¼Œå¯ä»¥åšåˆ°åŸºæœ¬ç§’å¼€ã€‚
å…·ä½“æ–¹æ¡ˆæ˜¯å°†é™æ€æ–‡ä»¶å’Œå›¾ç‰‡æ–‡ä»¶åˆ†åˆ«æ”¾åˆ°ä¸¤ä¸ªå­˜å‚¨æ¡¶é‡Œï¼Œæ”¾é™æ€æ–‡ä»¶çš„å­˜å‚¨æ¡¶CDNè®¾ç½®åšå®¢ä¸»åŸŸåï¼Œæ”¾å›¾ç‰‡çš„å­˜å‚¨æ¡¶CDNè®¾ç½®äºŒçº§åŸŸåï¼Œæ¯”å¦‚æˆ‘è®¾ç½®äº†â€¦â€¦"/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/59727fef85d99607.css" as="style"/><link rel="stylesheet" href="/_next/static/css/59727fef85d99607.css" data-n-g=""/><noscript data-n-css=""></noscript></head><body><div id="__next" data-reactroot=""><div class="blog-header min-w-full"><div class="container max-w-screen-lg px-2 clear-both"><div class="block text-center sm:inline-block sm:text-left "><div class=" inline-block align-top rounded-full my-2 mr-2 w-8 h-8 overflow-hidden bg-blue-400"><img class="site-logo" src="/medias/avatar.jpg" alt=""/></div><span class=" inline-block align-top mt-2.5 text-xl">liyang&#x27;s  blog</span></div><div class="block text-center sm:inline-block sm:text-left sm:float-right"><a class="inline-block nav-link py-3 px-2" href="/">é¦–é¡µ</a><a class="inline-block nav-link py-3 px-2" href="/archives/">å½’æ¡£</a><a class="inline-block nav-link py-3 px-2" href="/gallery/">ç›¸å†Œ</a><a class="inline-block nav-link py-3 px-2" href="/about/">å…³äº</a><span class="inline-block nav-link py-3 px-2" id="btn_toggle_theme" title="åˆ‡æ¢æš—è‰²æ¨¡å¼"><i class="theme-icon"></i></span></div></div></div><div class="blog-body pt-10 pb-10"><div class="container max-w-screen-lg px-3"><main class="flex"><article class="article-content mb-5 rounded p-5 w-full "><h1 class="text-xl md:text-2xl lg:text-2xl font-bold tracking-tighter leading-tight md:leading-none mb-6 text-center md:text-left">ä½¿ç”¨Travis-CIéƒ¨ç½²hexoåšå®¢åˆ°è…¾è®¯cos&amp;github-pages</h1><p class="mb-5 text-sm"><span class="mr-3">å‘å¸ƒæ—¥æœŸï¼š<!-- -->2020-01-16</span><span>æ–‡ç« å­—æ•°ï¼š<!-- -->2.2<!-- -->K</span></p><div class="mx-auto"><div class="markdown-body"><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä»¥å‰æˆ‘çš„åšå®¢é™æ€æ–‡ä»¶æ˜¯æ”¾åœ¨ä¸€ä¸ªå¸¦å®½1Mbpsçš„è…¾è®¯äº‘ä¸»æœºä¸Šï¼Œæ–‡ç« é‡Œçš„å›¾ç‰‡ä¹Ÿæ˜¯æ”¾åœ¨äº‘ä¸»æœºä¸Šçš„ï¼Œå½“æœ‰äº›æ–‡ç« å›¾ç‰‡è¾ƒå¤šçš„æ—¶å€™ï¼ŒåŠ è½½å°±ä¼šå˜å¾—å¾ˆæ…¢ã€‚åæ¥æˆ‘å°†é™æ€æ–‡ä»¶å’Œå›¾ç‰‡å…¨éƒ¨è¿ç§»åˆ°è…¾è®¯å¯¹è±¡å­˜å‚¨(cos)é‡Œï¼Œå¹¶é…ç½®äº†CDNåŠ é€Ÿï¼Œä»æ­¤åŠ è½½é€Ÿåº¦ä¸å†æ˜¯ç“¶é¢ˆï¼Œå¯ä»¥åšåˆ°åŸºæœ¬ç§’å¼€ã€‚</p>
<p>å…·ä½“æ–¹æ¡ˆæ˜¯å°†é™æ€æ–‡ä»¶å’Œå›¾ç‰‡æ–‡ä»¶åˆ†åˆ«æ”¾åˆ°ä¸¤ä¸ªå­˜å‚¨æ¡¶é‡Œï¼Œæ”¾é™æ€æ–‡ä»¶çš„å­˜å‚¨æ¡¶CDNè®¾ç½®åšå®¢ä¸»åŸŸåï¼Œæ”¾å›¾ç‰‡çš„å­˜å‚¨æ¡¶CDNè®¾ç½®äºŒçº§åŸŸåï¼Œæ¯”å¦‚æˆ‘è®¾ç½®äº†å›¾ç‰‡CDNäºŒçº§åŸŸåä¸º<code>images.liyangzone.com</code>ï¼Œå†™æ–‡ç« çš„æ—¶å€™å…ˆä¸Šä¼ å›¾ç‰‡åˆ°å­˜å‚¨æ¡¶ï¼Œç„¶ååœ¨æ–‡ç« é‡Œå°±å¯ä»¥ç›´æ¥å¼•ç”¨å›¾ç‰‡äº†ã€‚æ¯”å¦‚æˆ‘åœ¨å­˜å‚¨æ¡¶æ ¹ç›®å½•ä¸Šä¼ äº†ä¸€å¼ åä¸º<code>test.jpg</code>çš„å›¾ç‰‡ï¼Œå®ƒçš„åœ°å€å°±æ˜¯<code>images.liyangzone.com/test.jpg</code>ï¼Œè€Œä¸”æ”¯æŒå¤šçº§ç›®å½•ï¼Œæ¯”ä¸€äº›å›¾åºŠä»€ä¹ˆçš„è¦æ–¹ä¾¿å¾ˆå¤šï¼Œæœ‰äº›å›¾åºŠè™½ç„¶å…è´¹ï¼Œä½†æ˜¯å®ƒçš„æ–‡ä»¶åä¸€èˆ¬æ˜¯ä¸€ä¸ªæ— è§„å¾‹çš„å­—ç¬¦ä¸²ï¼Œç±»ä¼¼è¿™ç§<code>https://i.loli.net/2020/01/17/Mb1fywFLrJ8khUS.png</code>ï¼Œå½“ä½ ä¼ äº†å¾ˆå¤šå›¾ç‰‡æ—¶å¯èƒ½ä¼šä¸€è„¸æ‡µé€¼ï¼Œåˆ†ä¸æ¸…å“ªå¼ æ˜¯ä»€ä¹ˆå†…å®¹äº†ï¼Œä¸åˆ©äºç»´æŠ¤ã€‚</p>
<p>è€Œåšå®¢é™æ€æ–‡ä»¶å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>hexo-deployer-cos</code>è¿™ä¸ªæ’ä»¶æ¥æ›¿æˆ‘ä»¬å®Œæˆï¼Œå…·ä½“é…ç½®æ•™ç¨‹å¯å‚è€ƒæ­¤æ–‡ç« ï¼š<a href="https://cloud.tencent.com/developer/article/1185253">å¦‚ä½•åœ¨è…¾è®¯äº‘COSéƒ¨ç½²HEXOåšå®¢</a>ã€‚<br>é…ç½®å®Œäº†coså„ç§å‚æ•°åï¼Œæ‰§è¡Œ<code>hexo d</code>å‘½ä»¤å°±ä¼šå°†æœ¬åœ°æ–‡ä»¶ä¸Šä¼ è‡³cosäº†ï¼Œå¯æ˜¯è¿™ç§æ–¹å¼éœ€è¦æœ¬åœ°å®‰è£…nodejså’Œhexoï¼Œå¦‚æœæƒ³åœ¨åˆ«çš„ç”µè„‘ä¸Šå†™æ–‡ç« å°±ä¸æ–¹ä¾¿äº†ï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ›´åŠ ä¾¿æ·çš„éƒ¨ç½²æ–¹å¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œé‚£å°±æ˜¯â€”â€”<strong>æŒç»­é›†æˆ</strong>ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ"><a href="#ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ" class="headerlink" title="ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ"></a>ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ</h3><p>æŒç»­é›†æˆï¼ˆContinuous Integrationï¼‰æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘å®è·µã€‚ åœ¨æŒç»­é›†æˆä¸­ï¼Œå›¢é˜Ÿæˆå‘˜é¢‘ç¹é›†æˆä»–ä»¬çš„å·¥ä½œæˆæœï¼Œä¸€èˆ¬æ¯äººæ¯å¤©è‡³å°‘é›†æˆä¸€æ¬¡ï¼Œä¹Ÿå¯ä»¥å¤šæ¬¡ã€‚ æ¯æ¬¡é›†æˆä¼šç»è¿‡è‡ªåŠ¨æ„å»ºï¼ˆåŒ…æ‹¬è‡ªåŠ¨æµ‹è¯•ï¼‰çš„æ£€éªŒï¼Œä»¥å°½å¿«å‘ç°é›†æˆé”™è¯¯ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯Travis-CI"><a href="#ä»€ä¹ˆæ˜¯Travis-CI" class="headerlink" title="ä»€ä¹ˆæ˜¯Travis CI"></a>ä»€ä¹ˆæ˜¯Travis CI</h3><p>Travis CI æ˜¯ç›®å‰æ–°å…´çš„å¼€æºæŒç»­é›†æˆæ„å»ºé¡¹ç›®ï¼Œå®ƒä¸ jenkinsï¼ŒGO çš„å¾ˆæ˜æ˜¾çš„ç‰¹åˆ«åœ¨äºé‡‡ç”¨ yaml æ ¼å¼ï¼ŒåŒæ—¶å®ƒæ˜¯åœ¨çº¿çš„æœåŠ¡ï¼Œä¸åƒ jenkins éœ€è¦ä½ æœ¬åœ°æ­å»ºæœåŠ¡å™¨ï¼Œç®€æ´æ¸…æ–°ç‹¬æ ‘ä¸€å¸œã€‚ç›®å‰å¤§å¤šæ•°çš„ Github é¡¹ç›®éƒ½å·²ç»ç§»å…¥åˆ° Travis CI çš„æ„å»ºé˜Ÿåˆ—ä¸­ï¼Œæ®è¯´Travis CI æ¯å¤©è¿è¡Œè¶…è¿‡ 4000 æ¬¡å®Œæ•´æ„å»ºã€‚å¯¹äºåšå¼€æºé¡¹ç›®æˆ–è€… Github çš„ä½¿ç”¨è€…ï¼Œå¦‚æœä½ çš„é¡¹ç›®è¿˜æ²¡æœ‰åŠ å…¥ Travis CI æ„å»ºé˜Ÿåˆ—ï¼Œé‚£ä¹ˆæˆ‘çœŸçš„æƒ³å¯¹ä½ è¯´ OUT äº†ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆé€‰æ‹©Travis-CI"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©Travis-CI" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©Travis CI"></a>ä¸ºä»€ä¹ˆé€‰æ‹©Travis CI</h3><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦é€‰æ‹© Travis å‘¢ï¼Œå› ä¸ºå®ƒå’Œ Github é›†æˆçš„ç¨‹åº¦éå¸¸é«˜ï¼Œå¯¹äº Github ä¸Šçš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥å…è´¹åœ¨ Travis ä¸Šæ„å»ºï¼ˆä¸ºå…è´¹çš„äº’è”ç½‘ç²¾ç¥å¹²æ¯ğŸ»ï¼‰ï¼Œè€Œéå¼€æºçš„ç§æœ‰é¡¹ç›®æƒ³åœ¨ Travis ä¸Šæ„å»ºä»·æ ¼è¿˜æ˜¯éå¸¸æ„Ÿäººçš„ã€‚</p>
<h3 id="æŠ˜è…¾Travis-CIåæœ‰èƒ½è¾¾åˆ°ä»€ä¹ˆæ•ˆæœï¼Ÿ"><a href="#æŠ˜è…¾Travis-CIåæœ‰èƒ½è¾¾åˆ°ä»€ä¹ˆæ•ˆæœï¼Ÿ" class="headerlink" title="æŠ˜è…¾Travis CIåæœ‰èƒ½è¾¾åˆ°ä»€ä¹ˆæ•ˆæœï¼Ÿ"></a>æŠ˜è…¾Travis CIåæœ‰èƒ½è¾¾åˆ°ä»€ä¹ˆæ•ˆæœï¼Ÿ</h3><ol>
<li>ç›´æ¥åœ¨çº¿ç¼–è¾‘æ–‡ä»¶ï¼Œç«‹å³ç”Ÿæ•ˆï¼š<br>å‡è®¾ä½ å·²ç»å‘è¡¨äº†ä¸€ç¯‡æ–‡ç« ï¼Œè¿‡äº†å‡ å¤©ä½ åœ¨æœ‹å‹æœºå™¨ä¸Šæµè§ˆå‘ç°æœ‰å‡ ä¸ªæ˜æ˜¾çš„é”™åˆ«å­—ï¼Œå¯¹äºæœ‰å¼ºè¿«ç—‡çš„ï¼Œè¿™æ˜¯ä¸èƒ½å®¹å¿çš„ã€‚ ä½†ä½ æ‰‹å¤´åˆæ²¡æœ‰å®Œæ•´çš„hexo+nodejs+gitçš„å¼€å‘ç¯å¢ƒï¼Œé‡æ–°ä¸‹è½½gitï¼Œnodeï¼Œhexoé…ç½®ä¼šèŠ±è´¹ä¸å°‘æ—¶é—´ï¼Œç‰¹åˆ«ä¸åˆ’ç®—ã€‚</li>
</ol>
<p>  å¦‚æœæŒ‰ç…§è¿™ç¯‡å®Œæ•´æŠ˜è…¾å®Œï¼Œä½ å¯ä»¥ç›´æ¥ç”¨æµè§ˆå™¨è®¿é—®githubä¸ªäººé¡¹ç›®ä»“åº“ï¼Œç›´æ¥ç¼–è¾‘é‚£ç¯‡postçš„åŸmdæ–‡ä»¶ï¼Œå‰å2åˆ†é’Ÿæ”¹å®Œã€‚ ç¨ç­‰ç‰‡åˆ»ï¼Œä½ çš„åšå®¢å°±è‡ªåŠ¨æ›´æ–°äº†ã€‚<br> 2. è‡ªåŠ¨éƒ¨ç½²ï¼ŒåŒæ—¶éƒ¨ç½²åˆ°å¤šä¸ªåœ°æ–¹ï¼š<br>hexoåœ¨éƒ¨ç½²çš„æ—¶å€™å¯ä»¥è®¾ç½®éƒ¨ç½²åˆ°å¤šç«¯ï¼Œåªéœ€åœ¨åšå®¢é…ç½®æ–‡ä»¶é‡Œè®¾ç½®å¤šä¸ªdeployå³å¯ï¼Œæœ¬ç¯‡æ–‡ç« æš‚æ—¶åªå†™ä¸¤ç§ï¼Œgh-pageså’Œcosã€‚éƒ¨ç½²åˆ°æ›´å¤šåœ°æ–¹ä¹Ÿæ˜¯æ”¯æŒçš„ï¼Œæ¯”å¦‚gitlabï¼Œå›½å†…çš„codingç­‰ã€‚<br> 3. éƒ¨ç½²å¿«æ·æ–¹ä¾¿ï¼š<br>æ‰‹åŠ¨deployéœ€è¦æ¨é€publicæ•´ä¸ªfolderåˆ°githubä¸Šï¼Œå½“åæœŸç½‘ç«™æ–‡ç« ã€å›¾ç‰‡è¾ƒå¤šæ—¶å€™ï¼Œå¯¹äºå¤©æœçš„ç½‘ç»œï¼Œæœ‰æ—¶å€™è¿æ¥github å°±æ˜¯ä¸é¡ºç•…ï¼Œç»å¸¸è¦å‚»ç­‰ä¸å°‘ä¸Šä¼ æ—¶é—´ã€‚<br>æœ‰äº†CIï¼Œä½ å¯ä»¥åªæäº¤postæ–‡ä»¶é‡Œå•ç‹¬çš„mdæ–‡ä»¶å³å¯ï¼Œå¾ˆå¿«å¾ˆçˆ½ï¼Œè°ç”¨è°çŸ¥é“ã€‚</p>
<h3 id="Travisè‡ªåŠ¨æ„å»ºåŸç†"><a href="#Travisè‡ªåŠ¨æ„å»ºåŸç†" class="headerlink" title="Travisè‡ªåŠ¨æ„å»ºåŸç†"></a>Travisè‡ªåŠ¨æ„å»ºåŸç†</h3><ol>
<li>æ¯å½“æˆ‘ä»¬åœ¨æœ¬åœ°å†™å¥½äº†åšæ–‡ä¹‹åï¼Œpushåˆ°åšå®¢ä»“åº“çš„<code>blog-source</code>åˆ†æ”¯ã€‚</li>
<li>Travisä¸Šå¯ä»¥å¯¹è¿™ä¸ªé¡¹ç›®çš„<code>blog-source</code>åˆ†æ”¯è®¾ç½®é’©å­ï¼Œæ¯å½“æ£€æµ‹åˆ° push çš„æ—¶å€™å°±å»ä»“åº“ clone æºä»£ç åˆ°Travisçš„äº‘æœåŠ¡å™¨ä¸Šã€‚</li>
<li>Travisäº‘æœåŠ¡å™¨æŒ‰é¡ºåºæ‰§è¡Œä¸€ç³»åˆ—æ„å»ºè„šæœ¬ï¼Œæ¯”å¦‚ <code>npm install</code>ã€<code>hexo g</code> ã€<code>hexo d</code>ç­‰ã€‚</li>
</ol>
<h3 id="å¦‚ä½•æ“ä½œ"><a href="#å¦‚ä½•æ“ä½œ" class="headerlink" title="å¦‚ä½•æ“ä½œ"></a>å¦‚ä½•æ“ä½œ</h3><h4 id="1-é…ç½®hexoå¤šç«¯éƒ¨ç½²"><a href="#1-é…ç½®hexoå¤šç«¯éƒ¨ç½²" class="headerlink" title="1. é…ç½®hexoå¤šç«¯éƒ¨ç½²"></a>1. é…ç½®hexoå¤šç«¯éƒ¨ç½²</h4><p>ä¿®æ”¹åšå®¢æ ¹ç›®å½•é…ç½®æ–‡ä»¶<code>_config.yml</code>ï¼Œå‚è€ƒ<a href="https://hexo.io/zh-cn/docs/one-command-deployment">hexoå®˜æ–¹æ–‡æ¡£-éƒ¨ç½²</a>ï¼Œæˆ‘è¿™é‡Œåªè®¾ç½®äº†ä¸¤ä¸ªï¼Œgithub-pageså’Œcosï¼Œä¸‹é¢çš„å†™æ³•æ˜¯travis-ciéƒ¨ç½²åˆ°github-pageså’Œè…¾è®¯cos</p>
<pre><code class="yaml">#deploy:
- type: git
  branch: master
  repo: https://gh_token@github.com/liyang5945/liyang5945.github.io.git
- type: cos
  appId: cos_appId
  secretId: cos_secretId
  secretKey: cos_secretKey
  bucket: cos_bucket
  region: ap-shanghai
</code></pre>
<p>å¦‚æœä½ æ„Ÿè§‰traviså¤ªéº»çƒ¦ï¼Œä¸‹é¢çš„å†™æ³•æ˜¯æœ¬åœ°éƒ¨ç½²åˆ°github-pageså’Œè…¾è®¯cosï¼Œæ³¨æ„ä¸è¦æŠŠçœŸå®çš„secretIdç­‰å€¼æäº¤åˆ°githubä¸Šé¢ï¼Œè…¾è®¯äº‘ä¼šæ£€æµ‹åˆ°å¹¶æ‰“ç”µè¯æç¤ºä½ æœ‰å®‰å…¨é£é™©ï¼ˆä¸è¦é—®æˆ‘æˆ‘å’‹çŸ¥é“çš„ï¼‰ï¼Œå»ºè®®æœ¬åœ°éƒ¨ç½²çš„æ—¶å€™å¤åˆ¶è¿›å»ï¼Œéƒ¨ç½²å®Œåˆ é™¤å³å¯ã€‚</p>
<pre><code class="yaml">deploy:
  - type: git
    repo: https://github.com/liyang5945/liyang5945.github.io
  - type: cos
    appId: #ä½ çš„appId
    secretId: #ä½ çš„secretId
    secretKey: #ä½ çš„secretKey
    bucket: #æ­¤é¡¹æ ¼å¼ä¸ºå­˜å‚¨æ¡¶åç§°+appId
    region: ap-shanghai
</code></pre>
<h4 id="2-æ³¨å†Œtravisè´¦å·ï¼Œé…ç½®ç¯å¢ƒå˜é‡"><a href="#2-æ³¨å†Œtravisè´¦å·ï¼Œé…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2. æ³¨å†Œtravisè´¦å·ï¼Œé…ç½®ç¯å¢ƒå˜é‡"></a>2. æ³¨å†Œtravisè´¦å·ï¼Œé…ç½®ç¯å¢ƒå˜é‡</h4><p>æ³¨å†Œtravis-ciè´¦å·ï¼Œæ–°å»ºé¡¹ç›®ç­‰æ“ä½œå‚è€ƒæ­¤è´´ï¼š<a href="https://www.jianshu.com/p/e22c13d85659">æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨Travis CIè‡ªåŠ¨éƒ¨ç½²ä½ çš„Hexoåšå®¢åˆ°Githubä¸Š</a>ï¼Œè¿™é‡Œä¸å†ç»†è¯´ã€‚</p>
<p>æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯è¦æŠŠgithubçš„tokenå’Œcosçš„appIdç­‰æ·»åŠ åˆ°travisçš„ç¯å¢ƒå˜é‡é‡Œï¼Œè¿™æ ·travisäº‘æœåŠ¡å™¨æ‰èƒ½å¸®ä½ éƒ¨ç½²åˆ°githubå’Œcosï¼Œè®¾ç½®å¥½åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/travis-ci/20200118_103156.png"></p>
<h4 id="3-é…ç½®travisæ‰§è¡Œè„šæœ¬"><a href="#3-é…ç½®travisæ‰§è¡Œè„šæœ¬" class="headerlink" title="3. é…ç½®travisæ‰§è¡Œè„šæœ¬"></a>3. é…ç½®travisæ‰§è¡Œè„šæœ¬</h4><p>æœ€åè¿˜éœ€è¦æ–°å»ºä¸€ä¸ªtravisé…ç½®æ–‡ä»¶<code>.travis.yml</code>ï¼Œæ”¾åˆ°åšå®¢æ ¹ç›®å½•ä¸‹ï¼Œæˆ‘çš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="yaml">language: node_js

node_js: stable  # è¦å®‰è£…çš„nodeç‰ˆæœ¬ä¸ºå½“å‰çš„ç¨³å®šç‰ˆ

before_install:
  - export TZ=&#39;Asia/Shanghai&#39; # æ›´æ”¹æ—¶åŒº
install:
  - npm install

script:
  - hexo g

after_script:   # æœ€åæ‰§è¡Œçš„å‘½ä»¤

  - sed -i &quot;s/cos_appId/$&#123;cos_appId&#125;/g&quot; _config.yml
  - sed -i &quot;s/cos_secretId/$&#123;cos_secretId&#125;/g&quot; _config.yml
  - sed -i &quot;s/cos_secretKey/$&#123;cos_secretKey&#125;/g&quot; _config.yml
  - sed -i &quot;s/cos_bucket/$&#123;cos_bucket&#125;/g&quot; _config.yml
  - sed -i &quot;s/gh_token/$&#123;Travis_Token&#125;/g&quot; _config.yml
  - hexo deploy

branches:
  only:
    - blog-source # è§¦å‘æŒç»­é›†æˆçš„åˆ†æ”¯

env:
  global:
    - GH_REF: github.com/liyang5945/liyang5945.github.io.git # å°±æ˜¯ä½ githubä¸Šå­˜æ”¾é™æ€åšå®¢æœ€ç»ˆæ–‡ä»¶çš„ä»“åº“åœ°å€æœ«å°¾åŠ ä¸Š.git
</code></pre>
<p>åé¢çš„é‚£å‡ æ¡<code>sed</code>è¯­å¥çš„ä½œç”¨å°±æ˜¯ä»æˆ‘ä»¬é…ç½®çš„ç¯å¢ƒå˜é‡é‡Œè¯»å–çœŸå®çš„cos_appIdç­‰å‚æ•°æ›¿æ¢æœ¬åœ°ï¼ˆtravisäº‘æœåŠ¡å™¨æœ¬åœ°ï¼‰çš„<code>_config.yml</code>é‡Œçš„å½¢å‚ã€‚<br>æ›¿æ¢æˆçœŸå®å€¼ä¹‹åï¼Œå†æ‰§è¡Œ<code>hexo -d</code>å‘½ä»¤ï¼Œéƒ¨ç½²åˆ°gh-pageså’Œcosã€‚</p>
<p>å¦‚æœä½ åªéœ€è¦éƒ¨ç½²åˆ°gh-pagesï¼Œä¸‹é¢çš„éƒ¨ç½²å‘½ä»¤è¿˜å¯ä»¥å†™å‡ºä¸‹é¢è¿™æ ·ï¼Œä½ å¯ä»¥æ‰‹åŠ¨è®¾ç½®commitä¿¡æ¯ã€‚</p>
<pre><code class="yaml">after_script:
  - cd ./public
  - git init
  - git config user.name &quot;your name&quot;
  - git config user.email &quot;your email&quot;
  - git add .
  - git commit -m &quot;Update docs&quot;
  - git push --force --quiet &quot;https://$&#123;GH_TOKEN&#125;@$&#123;GH_REF&#125;&quot; master:master

branches:
  only:
    - blog-source # è§¦å‘æŒç»­é›†æˆçš„åˆ†æ”¯

env:
  global:
    - GH_REF: github.com/liyang5945/liyang5945.github.io.git
</code></pre>
<p>ä½†æ˜¯è¿™æ ·ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯commitè®°å½•åªæœ‰ä¸€æ¡ï¼Œå¦‚æœä½ åœ¨æ„è¿™ä¸ªé—®é¢˜ï¼Œé‚£å°±ä½¿ç”¨ä¸‹é¢çš„å†™æ³•ï¼Œå…ˆæ‹‰å–åˆ°æœ¬åœ°å†pushï¼š</p>
<pre><code class="yaml">after_script:
  - git clone https://$&#123;GH_REF&#125; .deploy_git  # GH_REFæ˜¯æœ€ä¸‹é¢é…ç½®çš„ä»“åº“åœ°å€
  - cd .deploy_git
  - git checkout master
  - cd ../
  - mv .deploy_git/.git/ ./public/   # è¿™ä¸€æ­¥ä¹‹å‰çš„æ“ä½œæ˜¯ä¸ºäº†ä¿ç•™masteråˆ†æ”¯çš„æäº¤è®°å½•ï¼Œä¸ç„¶æ¯æ¬¡git initçš„è¯åªæœ‰1æ¡commit
  - cd ./public
  - git config user.name &quot;your name&quot;  
  - git config user.email &quot;your email&quot;  
  - git add .
  - git commit -m &quot;Travis CI Auto Builder at `date +&quot;%Y-%m-%d %H:%M&quot;`&quot;  # æäº¤è®°å½•åŒ…å«æ—¶é—´ è·Ÿä¸Šé¢æ›´æ”¹æ—¶åŒºé…åˆ
  - git push --force --quiet &quot;https://$&#123;Travis_Token&#125;@$&#123;GH_REF&#125;&quot; master:master  #
</code></pre>
<h4 id="4-æµ‹è¯•æ˜¯å¦æˆåŠŸ"><a href="#4-æµ‹è¯•æ˜¯å¦æˆåŠŸ" class="headerlink" title="4. æµ‹è¯•æ˜¯å¦æˆåŠŸ"></a>4. æµ‹è¯•æ˜¯å¦æˆåŠŸ</h4><p>æ”¹åŠ¨æœ¬åœ°æ–‡ä»¶ç„¶åcommitï¼Œå¹¶pushåˆ°githubï¼Œä¸å‡ºæ„å¤–çš„è¯å¯ä»¥çœ‹åˆ°travisäº‘æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹ï¼š</p>
<p><img src="https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/travis-ci/20200118_115731.png"></p>
<p><img src="https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/travis-ci/20200118_115632.png"></p>
<p>æˆ‘ä»¬å†å»githubå’Œè…¾è®¯cosé‡Œçœ‹ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°commitè®°å½•å’Œæ–‡ä»¶ä¸Šä¼ æ—¥æœŸéƒ½æ˜¯æœ€æ–°çš„ã€‚</p>
<p><img src="https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/travis-ci/20200118_115141.png"></p>
<p><img src="https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/travis-ci/20200118_115525.png"></p>
</div><p class="date-info pt-8 font-bold leading-10 text-center hidden">æœ¬æ–‡å‘å¸ƒäºå¤©å‰ï¼Œæ–‡ä¸­æ‰€æè¿°çš„ä¿¡æ¯å¯èƒ½å·²å‘ç”Ÿæ”¹å˜</p></div></article></main></div></div><footer class="blog-footer bg-neutral-50 border-neutral-200"><div class="container max-w-screen-lg px-3"><div class="md:flex justify-between block text-sm py-2"><div class="py-1 mx-3 text-center">Copyright Â© 2019 - 2022 <!-- -->liyang&#x27;s  blog<a href="http://beian.miit.gov.cn/"> è±«ICPå¤‡19028870å· </a></div><div class="py-1 mx-3 text-center"> Powered by<a href="https://nextjs.org/"> Next.js </a>&amp;<a href="https://hexo.io/"> Hexo </a>Created by liyang</div></div></div></footer></div></body><script id="DarkModeScript">
    let html = document.documentElement;
    let  colorScheme = localStorage.getItem('colorScheme')
    if(colorScheme&&colorScheme=='dark'){
      html.setAttribute('data-color-mode', 'dark')
    } else {
      html.setAttribute('data-color-mode', 'light')
    }
    let btn_toggle_theme = document.querySelector('#btn_toggle_theme');
    btn_toggle_theme.addEventListener('click', function () {
    let theme = html.dataset.colorMode;
      if (theme == 'light') {
        html.setAttribute('data-color-mode', 'dark')
        localStorage.setItem('colorScheme','dark');
      } else if (theme == 'dark') {
        html.setAttribute('data-color-mode', 'light')
        localStorage.setItem('colorScheme','light');
      }
    })</script><script id="DynamicLoadScript">
function PromiseForEach(arr, cb) {
    let realResult = []
    let result = Promise.resolve()
    arr.forEach((a, index) => {
      result = result.then(() => {
        return cb(a).then((res) => {
          realResult.push(res)
        })
      })
    })
    return result.then(() => {
      return realResult
    })
 }
function addScript(url) {
   return new Promise((resolve, reject) => {
     let script = document.createElement('script');
     script.src = url;
     document.documentElement.appendChild(script);
     script.onload = ()=>{
       return resolve('success')
     }
     script.onerror = ()=>{
       return reject('error')
     }
   })
 }     
function AddCss(url) {
      document.head.insertAdjacentHTML("beforeend", `<link rel="stylesheet" href="${url}">`);
}
</script><script id="ArticleTocScript">
       window.articleDate = '2020-01-16';
      let tocLinks = document.querySelectorAll('.toc-text');
      let targetLinks = document.querySelectorAll('.headerlink')
      tocLinks.forEach(function (link) {
        link.addEventListener('click', function (event) {
        let target = event.target
        event.preventDefault()
        event.stopPropagation()
        let parent = target.parentNode;
        let hash = decodeURI(parent.hash);
        let targetLink = Array.prototype.find.call(targetLinks, function (item) {
          return item.getAttribute('href') == hash
        })
        let top = targetLink.offsetTop
        window.scrollTo(0, top - 100)
        })
      })
      let dateInfoEle = document.querySelector('.date-info');
      var articleDate = new Date(window.articleDate)
    if(new Date().getTime()-articleDate.getTime()>180 * 24 * 3600 *1000){
      let date = Math.ceil((new Date().getTime()-articleDate.getTime())/24/3600/1000)
      dateInfoEle.style.display = 'block';
      dateInfoEle.innerText = `æœ¬æ–‡å‘å¸ƒäº${date}å¤©å‰ï¼Œæ–‡ä¸­æ‰€æè¿°çš„ä¿¡æ¯å¯èƒ½å·²å‘ç”Ÿæ”¹å˜ã€‚`
    }
addScript('https://unpkg.com/@highlightjs/cdn-assets@11.5.0/highlight.min.js').then(res => {
   document.querySelectorAll('pre code').forEach((el) => {
    hljs.highlightElement(el);
  });
})     
      </script><script id="StatisticScript">
let runningOnBrowser = typeof window !== "undefined";
    let isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
let supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;
    if(!isBot&&supportsIntersectionObserver){
      if(!navigator.userAgent.includes('Chrome/78')){
        addScript('https://hm.baidu.com/hm.js?3123469f7f81d45d6c4cd4a6a84ccf68');
        addScript('https://js.users.51.la/21306481.js');
      }
    }
  </script></html>